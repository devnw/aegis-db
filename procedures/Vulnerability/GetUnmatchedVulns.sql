/*
  RETURN VulnerabilityInfo
  ID                      NVARCHAR(36)               NOT
  SourceVulnID            NVARCHAR(255)     NOT
  Title                   NVARCHAR(255)     NOT
  VulnerabilityID         VARCHAR(36)               NULL
  SourceID                VARCHAR(36)               NOT
  CVSSScore                    FLOAT             NOT
  CVSS3Score                   FLOAT             NULL
  Description             TEXT              NOT
  Solution                TEXT              NOT
*/

DROP PROCEDURE IF EXISTS `GetUnmatchedVulns`;

CREATE PROCEDURE `GetUnmatchedVulns` (_SourceID INT)
  #BEGIN#
  SELECT
    VI.Id,
    VI.SourceVulnId,
    VI.Title,
    VI.VulnerabilityId,
    VI.SourceId,
    VI.CVSS,
    VI.CVSS3,
    VI.Description,
    VI.Solution
  FROM VulnerabilityInfo VI
  WHERE VI.SourceId = _SourceID AND VI.VulnerabilityId IS NULL;