/*
  RETURN VulnerabilityInfo SINGLE
  ID                      VARCHAR(36)               NOT
  SourceVulnID            NVARCHAR(255)     NOT
  Title                   TEXT              NOT
  VulnerabilityID         VARCHAR(36)               NULL
  SourceID                VARCHAR(36)               NOT
  CVSSScore               FLOAT             NOT
  CVSS3Score              FLOAT             NULL
  Description             TEXT              NOT
  Solution                TEXT              NOT
  Software                TEXT              NULL
  DetectionInformation    TEXT              NULL
*/

DROP PROCEDURE IF EXISTS `GetVulnInfoBySourceVulnID`;

CREATE PROCEDURE `GetVulnInfoBySourceVulnID` (_SourceVulnID NVARCHAR(255))
  #BEGIN#
  SELECT
    VI.Id,
    VI.SourceVulnId,
    VI.Title,
    VI.VulnerabilityId,
    VI.SourceId,
    VI.CVSS,
    VI.CVSS3,
    VI.Description,
    VI.Solution,
    VI.Software,
    VI.DetectionInformation
  FROM VulnerabilityInfo VI
  WHERE VI.SourceVulnId = _SourceVulnID LIMIT 1;