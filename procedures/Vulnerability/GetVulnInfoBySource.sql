/*
  RETURN VulnerabilityInfo
  ID                      VARCHAR(36)               NOT
  Title                   NVARCHAR(255)     NOT
  SourceVulnID            NVARCHAR(255)     NOT
  VulnerabilityID         VARCHAR(36)               NULL
  SourceID                VARCHAR(36)               NOT
  CVSSScore                    FLOAT             NOT
  CVSS3Score                   FLOAT             NULL
  Description             TEXT              NOT
  Solution                TEXT              NOT
*/

DROP PROCEDURE IF EXISTS `GetVulnInfoBySource`;

CREATE PROCEDURE `GetVulnInfoBySource` (_Source NVARCHAR(50))
  #BEGIN#
  SELECT
    VI.Id,
    VI.Title,
    VI.SourceVulnId,
    VI.VulnerabilityId,
    VI.SourceId,
    VI.CVSS,
    VI.CVSS3,
    VI.Description,
    VI.Solution
  FROM VulnerabilityInfo VI
    JOIN Source S ON S.Id = VI.SourceId
  WHERE S.Source = _Source;