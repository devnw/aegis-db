/*
  RETURN VulnerabilityReferenceInfo
  VulnInfoID         VARCHAR(36)             NOT
  SourceID           VARCHAR(36)             NOT
  Reference          NVARCHAR(2083)    NOT
  RefType            INT    NOT
*/

DROP PROCEDURE IF EXISTS `GetVulnRefInfoVendor`;

CREATE PROCEDURE `GetVulnRefInfoVendor`(_VulnInfoID VARCHAR(255), _SourceID VARCHAR(36))
  #BEGIN#
  BEGIN
    SELECT
      VR.VulnInfoId,
      VR.SourceId,
      VR.Reference,
      VR.RefType
    FROM Vulnerability_Reference VR
      WHERE VR.VulnInfoId = _VulnInfoID
      and VR.SourceId= _SourceID
      and (VR.RefType=1 or VR.RefType=2);
  END;